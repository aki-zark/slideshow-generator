<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Slideshow - v017</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      background-color: #000;
    }

    /* スライドショー全体のコンテナ */
    .slideshow-container {
      width: 100vw;
      height: calc(var(--vh, 1vh) * 100);
      position: relative;
      overflow: hidden;
    }

    /* 各スライド */
    .slide {
      display: none;
      position: absolute;
      width: 100%;
      height: 100%;
      top: 0;
      left: 0;
      text-align: center;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    /* 画像のスタイル */
    .slide img {
      width: 100%;
      height: 100%;
      object-fit: contain;
      vertical-align: middle;
    }

    /* 手動切り替えボタン */
    .manual-btn-container {
      position: absolute;
      top: 50%;
      width: 100%;
      display: flex;
      justify-content: space-between;
      transform: translateY(-50%);
      z-index: 2;
    }

    .manual-prev-btn, .manual-next-btn {
      cursor: pointer;
      width: auto;
      padding: 16px;
      color: white;
      font-weight: bold;
      font-size: 20px;
      transition: 0.6s ease;
      background-color: rgba(0, 0, 0, 0.5);
      user-select: none;
    }

    .manual-prev-btn {
      border-radius: 0 3px 3px 0;
    }
    .manual-next-btn {
      border-radius: 3px 0 0 3px;
    }
    
    .manual-prev-btn:hover, .manual-next-btn:hover {
      background-color: rgba(0, 0, 0, 0.8);
    }

    /* 自動再生コントロールボタンと全画面表示ボタン */
    .controls {
      position: absolute;
      bottom: 10px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 2;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .controls button {
      padding: 10px 20px;
      margin: 0 5px;
      cursor: pointer;
      font-size: 16px;
      border: none;
      background-color: rgba(0, 0, 0, 0.5);
      color: white;
      border-radius: 5px;
    }

    .controls button:hover {
      background-color: rgba(0, 0, 0, 0.8);
    }
  </style>
</head>
<body>

<div class="slideshow-container">
  <div class="manual-btn-container">
    <span class="manual-prev-btn">&#10094;</span>
    <span class="manual-next-btn">&#10095;</span>
  </div>

  <div class="slide">
    <img src="0001.jpg" alt="Slide 1">
  </div>

  <div class="slide">
    <img src="0002.jpg" alt="Slide 2" loading="lazy">
  </div>

  <div class="slide">
    <img src="0003.jpg" alt="Slide 3" loading="lazy">
  </div>
  
  <div class="slide">
    <img src="0004.jpg" alt="Slide 4" loading="lazy">
  </div>
  
  <div class="slide">
    <img src="0005.jpg" alt="Slide 5" loading="lazy">
  </div>
  
  <div class="slide">
    <img src="0006.jpg" alt="Slide 6" loading="lazy">
  </div>
  
  <div class="slide">
    <img src="0007.jpg" alt="Slide 7" loading="lazy">
  </div>
  
  <div class="slide">
    <img src="0008.jpg" alt="Slide 8" loading="lazy">
  </div>

  <div class="controls">
    <button id="start-btn">自動再生開始</button>
    <button id="stop-btn">自動再生停止</button>
    <button id="fullscreen-btn">全画面表示</button>
  </div>
</div>

<script>
  // JavaScript
  const setVh = () => {
    let vh = window.innerHeight * 0.01;
    document.documentElement.style.setProperty('--vh', `${vh}px`);
  };

  window.addEventListener('load', setVh);
  window.addEventListener('resize', setVh);
  window.addEventListener('orientationchange', setVh);

  document.addEventListener('DOMContentLoaded', function() {
    const slideshowContainer = document.querySelector('.slideshow-container');
    const slides = document.getElementsByClassName("slide");
    const manualPrevBtn = document.querySelector(".manual-prev-btn");
    const manualNextBtn = document.querySelector(".manual-next-btn");
    const startBtn = document.getElementById("start-btn");
    const stopBtn = document.getElementById("stop-btn");
    const fullscreenBtn = document.getElementById("fullscreen-btn");
    
    let slideIndex = 1; 
    let autoplayInterval;

    function showSlide(n) {
      if (n > slides.length) { slideIndex = 1; }
      if (n < 1) { slideIndex = slides.length; }
      for (let i = 0; i < slides.length; i++) {
        slides[i].style.display = "none";
      }
      slides[slideIndex - 1].style.display = "flex";
    }

    function plusSlides(n) {
      showSlide(slideIndex += n);
    }
    
    manualPrevBtn.addEventListener('click', () => plusSlides(-1));
    manualNextBtn.addEventListener('click', () => plusSlides(1));

    function startAutoplay() {
      clearInterval(autoplayInterval);
      autoplayInterval = setInterval(() => {
        plusSlides(1);
      }, 1000); 
      console.log("自動再生が開始されました");
    }

    function stopAutoplay() {
      clearInterval(autoplayInterval);
      autoplayInterval = null;
      console.log("自動再生が停止されました");
    }

    startBtn.addEventListener('click', startAutoplay);
    stopBtn.addEventListener('click', stopAutoplay);

    fullscreenBtn.addEventListener('click', () => {
      if (document.fullscreenElement) {
        document.exitFullscreen();
        fullscreenBtn.textContent = '全画面表示';
      } else {
        slideshowContainer.requestFullscreen().catch(err => {
          alert(`全画面表示を有効にできませんでした: ${err.message}`);
        });
        fullscreenBtn.textContent = '元に戻す';
      }
    });

    // キーボード操作
    document.addEventListener('keydown', (e) => {
      if (e.key === "ArrowLeft") {
        plusSlides(-1);
      } else if (e.key === "ArrowRight") {
        plusSlides(1);
      }
    });

    // スワイプ操作の追加 - ここが変更点
    let touchstartX = 0;
    let touchendX = 0;
    const swipeThreshold = 50; // スワイプと認識する最小のピクセル数

    slideshowContainer.addEventListener('touchstart', e => {
      touchstartX = e.changedTouches[0].screenX;
    });

    slideshowContainer.addEventListener('touchend', e => {
      touchendX = e.changedTouches[0].screenX;
      handleGesture();
    });

    function handleGesture() {
      if (touchendX < touchstartX - swipeThreshold) {
        // 左にスワイプ
        plusSlides(1);
      }
      
      if (touchendX > touchstartX + swipeThreshold) {
        // 右にスワイプ
        plusSlides(-1);
      }
    }

    showSlide(slideIndex);
  });
</script>

</body>
</html>